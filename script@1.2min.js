function isMobile(){return window.innerWidth<992}function resetWebflow(e){let t=new DOMParser().parseFromString(e.next.html,"text/html").querySelector("html").getAttribute("data-wf-page");document.documentElement.setAttribute("data-wf-page",t),window.Webflow.destroy(),window.Webflow.ready(),window.Webflow.require("ix2").init()}function initMotherPage(){let e=document.querySelector("#family-url"),t=document.querySelectorAll(".modal-close");if(e&&t.length){let r=e.getAttribute("href");t.forEach(e=>{e.setAttribute("href",r)})}}function initFamilyBottom(e){e||(e=document);let t=document.querySelector("body");var r=parseInt(e.querySelector("[data-index]").textContent,10);let o=e.querySelectorAll("[data-family-bottom] .slider-item"),i=o.length;var a=r-1<1?i-1:r-2,n=r%i;r-1<1&&setTimeout(()=>{o[i-1].style.order=1},150),0===n&&setTimeout(()=>{o[0].style.order=3},150),o.forEach((e,t)=>{let r=t===a,o=t===n;r&&e.querySelectorAll(".button-text").forEach(e=>{e.textContent="previous"});let i=isMobile()?o:r||o;i?(e.style.display="block",e.style.order=2):e.remove()});let l=e.querySelector("[data-family-bottom]").querySelectorAll(".slider-item");function s(e){let t,r=!e.hasAttribute("data-video-url-mobile");(t=window.innerWidth<480&&!r?e.getAttribute("data-video-url-mobile"):e.getAttribute("data-video-url"))?(e.src=t,e.setAttribute("muted",""),e.setAttribute("playsinline",""),e.setAttribute("autoplay",""),e.load()):console.log("No video source found for",r?"main video":"background video")}function c(e,t){e.forEach(e=>{let t=e.target,r=t.querySelector(".bg-vid"),o=t.querySelector(".slide-vid");e.isIntersecting?(r&&r.play(),o&&(o.currentTime=r.currentTime,o.play()),r&&o&&r.currentTime!==o.currentTime&&(o.currentTime=r.currentTime)):(r&&r.pause(),o&&(o.pause(),o.currentTime=r.currentTime))})}window.innerWidth<992&&l.forEach(e=>{let t=e.querySelector(".bg-vid"),r=e.querySelector(".slide-vid");t&&s(t),r&&(s(r),r.currentTime=t.currentTime)});let u={root:null,rootMargin:"0px",threshold:.5},d=()=>{let e=new IntersectionObserver(c,u);l.forEach(t=>e.observe(t))},m=(e,t,r,o)=>{t&&(y(t),r&&r.currentTime&&(t.currentTime=r.currentTime),t.volume=0,t.play()),r&&y(r,!1)};function y(e,t=!0,r=!1){let o;o=r&&window.innerWidth<480?e.getAttribute("data-video-url-mobile"):e.getAttribute("data-video-url"),e&&!e.src&&o?fetch(o).then(e=>{if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);return e.blob()}).then(r=>{e.src=URL.createObjectURL(r),e.load(),t&&e.play()}).catch(e=>{console.warn("Video playback failed",e)}):t&&e.src&&e.play()}l.forEach((e,r)=>{let o=e.querySelector(".slide-vid"),i=e.querySelector(".bg-vid"),a=parseInt(e.querySelector("[data-score]").textContent,10)-1;t.classList.contains("no-hover")||window.innerWidth<992?d():(e.addEventListener("mouseenter",()=>{let t=document.querySelectorAll(".tl-item")[a];t.classList.add("active"),m(e,o,i,a)}),e.addEventListener("mouseleave",()=>{o&&o.pause(),i&&i.pause();let e=document.querySelectorAll(".tl-item")[a];e.classList.remove("active")})),m(e,o,i,a)}),window.innerWidth>991&&gsap.delayedCall(.1,()=>{let e=document.querySelector(".two-col");if(e){let t=e.children;if(t.length%2!=0){let r=document.querySelector(".product-item.is--empty");r&&(e.appendChild(r),r.classList.remove("u--hide"))}}}),r=null,n=null,a=null}function removeFamilyNav(){document.querySelector(".tl-w").removeEventListener("mouseenter",!1)}function makeItemActive(){let e=document.querySelector('[data-barba-namespace="family"] .f-hero .slider-title'),t=e?e.textContent:"",r=document.querySelectorAll("[data-home-slider] .slider-item");r&&r.forEach(function(e){let r=e.querySelector(".slider-title"),o=r?r.textContent:"";o===t&&e.classList.add("is--transitioning")});let o=document.querySelectorAll("[data-family-bottom] .slider-item");o&&o.forEach(function(e){let r=e.querySelector(".slider-title"),o=r?r.textContent:"";o===t&&e.classList.add("is--transitioning")})}function makeItemActiveTest(e,t){let r=e.querySelector('[data-barba-namespace="family"] .f-hero .slider-title'),o=r?r.textContent:"",i=t.querySelectorAll("[data-family-bottom] .slider-item");i&&i.forEach(function(e){let t=e.querySelector(".slider-title"),r=t?t.textContent:"";r===o&&e.classList.add("is--transitioning")})}function flip(e,t){let r=Flip.getState(e.find(".slide-inner")),o=e.find(".slide-inner");t.find(".slide-info__wrap").remove(),o.appendTo(t),Flip.from(r,{duration:1,ease:"power4.inOut",absolute:!0})}function flipTest(e,t){let r=Flip.getState(e.find(".slide-inner")),o=e.find(".slide-inner");t.querySelector(".slide-info__wrap").remove(),o.appendTo(t),Flip.from(r,{duration:1,ease:"power4.inOut",absolute:!0})}function runFamilyAfter(){let e=document.querySelector(".tl-line");gsap.to(e,{scaleX:0,ease:"expo.out",duration:.5});document.querySelector(".f-hero__down").classList.remove("u--hide");let t=document.querySelector(".slide-vid__wrap");t&&t.remove();let r=document.querySelector('[data-video="blur"]'),o=document.querySelector('[data-video="full"]'),i=document.querySelector("[data-image-blur]");o.currentTime=r.currentTime,gsap.set(o,{opacity:1}),gsap.to(r,{opacity:0,duration:.5,delay:1,ease:"power3.inOut"}),gsap.to(i,{opacity:0,duration:.001,delay:1,ease:"power3.inOut"})}function runFamilyNavTransition(){document.querySelector(".family-nav").querySelectorAll(".bg-vid").forEach(e=>{e.pause()}),currentTimeline&&currentTimeline.reverse();gsap.timeline({}).to(".family-nav",{height:"0px",ease:"power4.out",duration:1.2}).to(".nav-bg",{height:"0%",overwrite:"height",ease:"power4.out",duration:1},0).to(".nav-page__bg",{opacity:0,duration:1,ease:"power4.out"}).fromTo(".swiper-slide.is--family",{opacity:1,yPercent:0},{opacity:0,yPercent:50,ease:"power4.out",duration:1,stagger:{each:.02}},0)}barba.hooks.after(e=>{$(e.next.container).removeClass("fixed"),$(".is--transitioning").removeClass("is--transitioning"),$(".u--z-index-5").removeClass("u--z-index-5"),resetWebflow(e),lenis.scrollTo(0,{immediate:!0,force:!0,lock:!0,onComplete(){lenis.start(),ScrollTrigger.refresh()}})}),barba.hooks.leave(e=>{lenis.stop()}),barba.hooks.enter(e=>{$(e.next.container).addClass("fixed"),$(e.next.container).addClass("u--z-index-5")}),barba.init({preventRunning:!0,prevent:function({el:e}){return e.hasAttribute("data-barba-prevent")},transitions:[{name:"home-default",sync:!0,to:{namespace:["play"]},afterEnter(){window.location.reload(),initHomeLoader()}},{name:"stores-default",sync:!0,to:{namespace:["stores"]},afterEnter(){window.location.reload()}},{name:"family-to-family-nav",sync:!0,leave:e=>(navBoolean=!1,runFamilyNavTransition(),gsap.to(e.current.container,{opacity:0,delay:.2,duration:1})),enter(e){gsap.from(e.next.container,{opacity:0,duration:1})},custom({trigger:e}){let t=e.classList.contains("family-slider__video");return t}},{name:"mother",sync:!0,to:{namespace:["mother"]},afterEnter(){initMotherPage()}},{name:"home-to-family",sync:!0,from:{namespace:["play"]},to:{namespace:["family"]},beforeEnter(){let e=document.querySelector('[data-video="full"]');gsap.set(e,{opacity:0}),gsap.set(".slider-item",{pointerEvents:"none"}),gsap.set(".cursor-main",{autoAlpha:0,overwrite:!0})},enter(e){makeItemActive(),flip($(".is--transitioning"),$(".f-hero"));let t=e.next.container.querySelector(".f-hero"),r=t.querySelector(".button-filled.is--slide"),o=t.querySelector(".slide-vid__wrap"),i=document.querySelector(".cursor-w");return gsap.to(".cursor-img",{opacity:0,scale:.6,stagger:.025,onComplete(){i.remove()}}),gsap.to(".slide-bg__wrap",{xPercent:0,overwrite:!0,duration:1,ease:"power4.inOut"}),gsap.to(r,{yPercent:50,opacity:0,onComplete(){gsap.set(r,{display:"none"})}}),gsap.to(o,{opacity:0,duration:.2,ease:"power4.out"}),gsap.to('[data-video="full"]',{opacity:1,delay:1,duration:.2,ease:"power4.out"}),gsap.to(e.current.container,{opacity:0,duration:1.05,ease:"power4.out"})},after(e){lenis.destroy(),lenis=new Lenis({lerp:.2,orientation:"vertical",gestureOrientation:"vertical"});let t=document.querySelectorAll("[data-family-bottom] .slider-item");t.forEach(e=>{e.style.display="block"}),runFamilyAfter(),gsap.set(".slider-item",{pointerEvents:"auto",clearProps:"all"})},afterEnter(){}},{name:"family-to-home",sync:!0,from:{namespace:["family"]},to:{namespace:["play"]},enter:e=>(closeMainMenu(),gsap.to(e.current.container,{opacity:0,duration:.5})),afterEnter(){initHomeLoader(),window.location.reload()}},{name:"stores-to-home",sync:!0,from:{namespace:["stores"]},to:{namespace:["play"]},enter:e=>(closeMainMenu(),gsap.to(e.current.container,{opacity:0,duration:.5})),afterEnter(){initHomeLoader()},after(){window.location.reload()}},{name:"family-to-family-bottom",sync:!0,beforeEnter(){let e=document.querySelectorAll('[data-video="full"]');gsap.set(e,{opacity:0}),gsap.set(".slider-item",{pointerEvents:"none"}),gsap.set(".cursor-main",{autoAlpha:0,overwrite:!0})},enter(e){makeItemActiveTest(e.next.container,e.current.container);let t=e.next.container.querySelector(".f-hero");flipTest($(".is--transitioning"),t);let r=e.next.container.querySelector(".f-hero"),o=r.querySelector(".button-filled.is--slide");r.querySelector(".slide-vid__wrap");let i=r.querySelector(".bottom-vid__wrap");return gsap.to(".slide-bg__wrap",{xPercent:0,overwrite:!0,duration:1,ease:"power4.inOut"}),gsap.to(o,{yPercent:50,opacity:0,onComplete(){gsap.set(o,{display:"none"})}}),gsap.to(i,{opacity:0,duration:.2,ease:"power4.out"}),gsap.to('[data-video="full"]',{opacity:1,delay:1,duration:.2,ease:"power4.out"}),gsap.to(e.current.container,{opacity:0,duration:1.05,ease:"power4.out"})},after(){gsap.set(".slider-item",{pointerEvents:"auto",clearProps:"all"}),runFamilyAfter()},custom({trigger:e}){let t=e.hasAttribute("data-family-bottom-link");return t}},{name:"family-default",sync:!0,to:{namespace:["family"]},afterEnter(e){runFamilyAfter(),setTimeout(initFamilyBottom(e.next.container),50)}},],views:[{namespace:"play",afterEnter(){initSlider(),removeFamilyNav()}},{namespace:"family",afterEnter(e){initFamilyPage(e.next.container),runFamilyAfter(),setTimeout(initFamilyBottom(e.next.container),50)}},{namespace:"mother",afterEnter(e){initMotherPage(),initFamilyPage(e.next.container)}},]});