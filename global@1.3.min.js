document.addEventListener("DOMContentLoaded",function(){let e,t;function o(){return window.matchMedia("(orientation: landscape) and (max-height: 500px)").matches}function a(){let o=document.querySelectorAll(".e-img"),a=document.querySelectorAll(".e-item"),n=0;function l(e){o.forEach(e=>{e.style.opacity=0}),a.forEach(e=>{e.style.opacity=0}),o[e].style.opacity=1,a[e].style.opacity=1}document.querySelector("[data-pagination-next]").addEventListener("click",function(){l(n=(n+1)%o.length)}),document.querySelector("[data-pagination-prev]").addEventListener("click",function(){l(n=(n-1+o.length)%o.length)}),l(n);let r=document.getElementById("cameraView"),i=document.querySelector(".page-w");r.style.display="block",i.style.visibility="hidden",t||((t=document.createElement("video")).setAttribute("playsinline",""),t.setAttribute("autoplay",""),t.setAttribute("muted",""),t.classList.add("bg-vid"),t.style.transform="scaleX(-1)",r.appendChild(t)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}).then(function(o){e=o,t.srcObject=o}).catch(function(e){console.error("Error accessing the camera: ",e)}):console.error("Your browser does not support getUserMedia API")}o()&&a(),window.addEventListener("resize",function(){if(o())a();else{e&&(e.getTracks().forEach(e=>e.stop()),e=null),document.getElementById("cameraView").style.display="none",t&&(t.srcObject=null);let n=document.getElementById("cameraView"),l=document.querySelector(".page-w");n.style.display="none",l.style.display="block"}})}),gsap.defaults({ease:"power4.inOut",duration:.6});let openedColumn=null,thirdColumn=!1;function toggleMenu(e){let t=e.getAttribute("data-menu-link"),o=e.querySelector(".h-reg").innerText,a=document.querySelector(`[data-menu="${t}"]`);a.querySelectorAll("[data-menu-name").forEach(e=>{e.innerText=o});let n=document.querySelector('[data-menu="country"]'),l=document.querySelector('[data-menu="family"]'),r=document.querySelector('[data-menu="stores"]'),i=document.querySelector('[data-menu="collections"]');if(a!==openedColumn){if((a===n||a===l)&&(thirdColumn=!0),document.querySelectorAll(".menu-link.is--main").forEach(t=>{e.classList.contains("is--main")&&t.classList.toggle("is--inactive",t!==e)}),"family"===t||"country"===t)openedColumn=a,gsap.set(a,{display:"block"}),gsap.fromTo(a,{x:"-101%"},{x:"0%"}),gsap.to("[data-info-line]",{y:"100%",autoAlpha:0,ease:"power3.out",stagger:{each:.02,from:"end"}});else{if(thirdColumn){gsap.to([r,i],{x:"-101%",duration:.5,onComplete(){gsap.set([r,i],{display:"none"}),openedColumn=a,gsap.set(a,{display:"block"}),gsap.fromTo(a,{x:"-101%"},{x:"0%"}),gsap.to("[data-info-line]",{y:"100%",autoAlpha:0,ease:"power3.out",stagger:{each:.02,from:"end"}}),document.querySelectorAll(".menu-link.is--country").forEach(e=>{e.classList.remove("is--inactive")})}}),gsap.to([n,l],{x:"-201%",duration:.4,onComplete(){gsap.set([n,l],{display:"none"}),openedColumn=null,thirdColumn=null}});return}gsap.to(openedColumn,{x:"-101%",duration:openedColumn?.4:0,onComplete(){gsap.set(openedColumn,{display:"none"}),openedColumn=a,gsap.set(a,{display:"block"}),gsap.fromTo(a,{x:"-101%"},{x:"0%"}),gsap.to("[data-info-line]",{y:"100%",autoAlpha:0,ease:"power3.out",stagger:{each:.02,from:"end"}})}})}}}function closeMenu(e){let t=e.getAttribute("data-menu-close"),o=document.querySelector(`[data-menu="${t}"]`);openedColumn?(gsap.to(o,{x:"-101%",duration:.5,onComplete(){gsap.set(o,{display:"none"})}}),gsap.to(openedColumn,{x:"-201%",duration:.4,onComplete(){gsap.set(openedColumn,{display:"none"}),openedColumn=null}}),gsap.to("[data-info-line",{y:"0%",autoAlpha:1,ease:"power3.out",stagger:{each:.02,from:"start"}})):o&&(gsap.to(o,{x:"-101%",duration:.4,onComplete(){gsap.set(o,{display:"none"})}}),gsap.to("[data-info-line",{y:"0%",autoAlpha:1,ease:"power3.out",stagger:{each:.02,from:"start"}})),document.querySelectorAll(".menu-link").forEach(e=>{e.classList.remove("is--inactive")})}function openMainMenu(){gsap.to(".cursor-main",{autoAlpha:0,y:"1rem",overwrite:!0});let e=gsap.timeline();gsap.set(".menu-w",{display:"flex"});let t=document.querySelector(".main-w").getAttribute("data-barba-namespace");currentTimeline&&currentTimeline.reverse(),e.to(".menu-col.is--main",{x:0,duration:.6}).to("#menu-button",{color:"transparent",duration:.4,onStart(){gsap.set(".nav-w",{pointerEvents:"none"})}},0).fromTo(".menu-link.is--main",{autoAlpha:0,y:"50%"},{autoAlpha:1,y:"0%",duration:.45,stagger:.05,clearProps:"all"},"0.3").from("[data-info-line]",{autoAlpha:0,y:"50%",duration:.45,stagger:.05},"<").to("[data-nav-fade]",{autoAlpha:0,y:"1rem",duration:.45,stagger:.025},0).to(".tl-line__wrap",{scaleX:0,duration:.45},0).fromTo(".menu-bg",{opacity:0},{opacity:1,duration:.45},0),"play"!==t&&e.fromTo(".menu-bg",{backdropFilter:"blur(0px)"},{backdropFilter:"blur(20px)",duration:.4},0).to(".nav-w",{yPercent:-100,duration:.45},0)}function closeMainMenu(){lenis.start();let e=document.querySelector(".main-w").getAttribute("data-barba-namespace"),t="stores"===e,o=gsap.timeline({onComplete(){gsap.set(".menu-w",{display:"none"}),t||gsap.set(".nav-w",{pointerEvents:"auto"})},onStart(){gsap.set(".nav-w",{pointerEvents:"none"})}});o.to(".menu-col.is--main",{x:"-101%",duration:.5}).to("[data-nav-fade]",{autoAlpha:1,y:"0rem",duration:.35,stagger:.025},0).to("[data-info-line]",{autoAlpha:1,y:"0%",duration:.35,stagger:.025},0).to(".tl-line__wrap",{scaleX:1,duration:.35},0).to("#menu-button",{color:"#fff",duration:.4,clearProps:"all",onEnd(){gsap.set(".nav-w",{pointerEvents:"auto",clearProps:!0})}},0).to(".menu-bg",{opacity:0,duration:.45},0).to(".nav-bg",{height:navBoolean?"100%":"0%",duration:.45},0).to(".nav-w",{y:0,opacity:1,duration:.45},0),openedColumn&&o.to(openedColumn,{x:"-301%",duration:.5,onComplete(){gsap.set(openedColumn,{display:"none"}),openedColumn=null}},0),openedColumn&&(openedColumn.matches(".menu-col.is--family")||openedColumn.matches(".menu-col.is--stores"))&&o.to([".menu-col.is--collection",".menu-col.is--countries"],{x:"-201%",duration:.5,onComplete(){gsap.set(".menu-col.is--collection",{display:"none"}),gsap.set(".menu-col.is--countries",{display:"none"}),openedColumn=null}},0),"play"!==e&&o.fromTo(".menu-bg",{backdropFilter:"blur(20px)"},{backdropFilter:"blur(0px)",duration:.4},0),document.querySelectorAll(".menu-link").forEach(e=>{e.classList.remove("is--inactive")})}document.querySelectorAll("[data-menu-link]").forEach(e=>{e.addEventListener("click",()=>toggleMenu(e))}),document.querySelectorAll("[data-menu-close]").forEach(e=>{e.addEventListener("click",()=>{"main"===e.getAttribute("data-menu-close")?closeMainMenu():closeMenu(e)})}),document.getElementById("menu-button").addEventListener("click",openMainMenu),document.getElementById("menu-bg").addEventListener("click",closeMainMenu),document.getElementById("close-button").addEventListener("click",closeMainMenu),document.querySelectorAll(".menu-link.is--country").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll(".menu-link.is--country").forEach(e=>{e.classList.add("is--inactive")}),this.classList.remove("is--inactive")})});let storeLinks=document.querySelectorAll('[data-menu-link="country"]');storeLinks.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("data-url"),o=`${window.location.origin}/countries/${t}`;function a(){fetch(o).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.text()}).then(e=>{let t=new DOMParser,o=t.parseFromString(e,"text/html"),a=o.querySelector("[data-store-list]"),n=document.querySelector("[data-store-wrap]");a&&n&&(n.innerHTML=a.innerHTML),openedColumn&&gsap.to(openedColumn,{xPercent:0,ease:"power3.out",duration:.5})}).catch(e=>{console.error("There has been a problem with your fetch operation:",e)})}openedColumn?gsap.fromTo(openedColumn,{xPercent:0},{xPercent:-101,ease:"power3.out",duration:.5,onComplete:a}):a()})});let familyLinks=document.querySelectorAll('[data-menu-link="family"]'),familyButton=document.querySelectorAll("[data-family-button]");familyButton.forEach(e=>{e.addEventListener("click",closeMainMenu)}),familyLinks.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("data-url"),o=`${window.location.origin}/families/${t}`;function a(){fetch(o).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.text()}).then(e=>{let t=new DOMParser,o=t.parseFromString(e,"text/html"),a=o.querySelectorAll("[data-family-item]"),n=document.querySelector("[data-family-wrap]");a.length>0&&n&&(n.innerHTML="",a.forEach(e=>{e.classList.add("is--menu");let t=e.querySelector(".product-item__img");t&&(t.classList.remove("product-item__img"),t.classList.add("menu-family__img")),n.appendChild(e)})),openedColumn&&gsap.to(openedColumn,{xPercent:0,ease:"power3.out",duration:.5})}).catch(e=>{console.error("There has been a problem with your fetch operation:",e)})}familyButton.forEach(e=>{e.setAttribute("href",o)}),openedColumn?gsap.fromTo(openedColumn,{xPercent:0},{xPercent:-101,ease:"power3.out",duration:.5,onComplete:a}):a()})}),document.querySelectorAll("[data-email-link]").forEach(e=>{let t,o=e.parentElement.querySelector("[data-email-text]");e.addEventListener("mouseenter",()=>{t=o.textContent,o.textContent="click to copy email"}),e.addEventListener("mouseleave",()=>{o.textContent=t}),e.addEventListener("click",()=>{o.textContent="copied email address!",navigator.clipboard.writeText(e.textContent).then(()=>{setTimeout(()=>{o.textContent=t},2e3)})})}),window.innerWidth<480&&document.querySelectorAll(".menu-close").forEach(e=>{e.setAttribute("data-menu-close","main")});let savedModels=getSavedModels();updateAllSaveIcons(savedModels),setupSaveIconClickHandlers(),checkAndToggleShareButtonVisibility();const urlParams=new URLSearchParams(window.location.search),wishlistItemsFromURL=urlParams.get("wishlist");if(wishlistItemsFromURL){let e=wishlistItemsFromURL.split(",").map(decodeURIComponent).map(slugifyModelName);updateAllSaveIcons(savedModels=[...new Set([...savedModels,...e])])}function slugifyModelName(e){return e.toLowerCase().replace(/[\s+\/]/g,"-")}function getSavedModels(){let e=JSON.parse(localStorage.getItem("savedModels")||"[]").map(slugifyModelName),t=new URLSearchParams(window.location.search),o=t.get("wishlist");if(o){let a=o.split(",").map(decodeURIComponent).map(slugifyModelName);e=[...new Set([...e,...a])],localStorage.setItem("savedModels",JSON.stringify(e))}return e}function updateAllSaveIcons(e){document.querySelectorAll(".save-icon").forEach(t=>{let o=t.getAttribute("data-model"),a=slugifyModelName(o);e.includes(a)?t.classList.add("is--saved"):t.classList.remove("is--saved")})}function updateWishlistSaveIcons(){let e=document.querySelector("[data-wishlist-wrap]");e&&e.querySelectorAll(".save-icon").forEach(e=>{e.classList.add("is--saved")})}function setupSaveIconClickHandlers(){document.querySelectorAll(".save-icon").forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-model");toggleModelIdInLocalStorage(e,this),checkAndToggleShareButtonVisibility(),updateWishlistSaveIcons()})})}function toggleModelIdInLocalStorage(e,t){let o=JSON.parse(localStorage.getItem("savedModels")||"[]").map(slugifyModelName),a=slugifyModelName(e),n=o.indexOf(a);if(-1===n){if(0===o.length){let l=document.querySelector("#w-modal-toggle");l&&l.click()}o.push(a),t.classList.add("is--saved");let r=slugifyModelName(e),i=`/models/${r}`;fetchModelItem(i,document.querySelector("[data-wishlist-wrap]"))}else{o.splice(n,1),t.classList.remove("is--saved"),t.closest(".menu-col.is--wishlist")&&t.parentElement.parentElement.remove();let s=document.querySelector(`[data-wishlist-item="${e}"]`);s&&s.remove()}localStorage.setItem("savedModels",JSON.stringify(o)),checkAndToggleShareButtonVisibility()}function checkAndToggleShareButtonVisibility(){let e=JSON.parse(localStorage.getItem("savedModels")||"[]"),t=document.querySelector('[data-wishlist="share"]');t&&(0===e.length?t.classList.add("u--hide"):t.classList.remove("u--hide"))}function loadWishlistItems(e){if(0===e.length)return;let t=document.querySelector("[data-wishlist-wrap]");if(t)Promise.all(e.map(e=>{let o=`/models/${e}`;return fetchModelItem(o,t)})).then(()=>{updateWishlistSaveIcons(),updateAllSaveIcons(e),setupSaveIconClickHandlers()})}function fetchModelItem(e,t){return new Promise((o,a)=>{fetch(e).then(e=>{if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);return e.text()}).then(e=>{let n=new DOMParser,l=n.parseFromString(e,"text/html"),r=l.querySelector("[data-wishlist-item]");r?(t.appendChild(r),o()):a("Wishlist item not found in the response")}).catch(e=>{a(e)})})}function generateShareableLink(){let e=getSavedModels(),t=e.map(encodeURIComponent).join(","),o=window.location.origin,a=`${o}?wishlist=${t}`,n=document.querySelector('[data-wishlist="button-text"]');navigator.clipboard.writeText(a).then(()=>{let e=n.innerText;n.innerText="Copied to clipboard",setTimeout(()=>{n.innerText=e},3e3)}).catch(e=>{console.error("Failed to copy URL:",e)})}loadWishlistItems(savedModels);const shareButton=document.querySelector('[data-wishlist="share"]');function initFamilyPage(){ScrollTrigger.refresh();let e=document.querySelector(".nav-w"),t=document.querySelectorAll(".tl-item");e.setAttribute("state","default"),e.classList.remove("scrolled");let o,a;setTimeout(function e(){a=parseInt(o=document.querySelector("[data-index]").textContent,10)-1,t.forEach((e,t)=>{e.classList.remove("hovered");let o=e.querySelector(".item-dot");gsap.to(o,{backgroundColor:"#fff",duration:.2,clearProps:"backgroundColor"}),t!==a?e.classList.remove("active"):e.classList.add("active")})},50),gsap.to(".modal-close",{height:"0rem",duration:.45,ease:"expo.out"});let n=new Swiper(".swiper.is--family",{slidesPerView:"auto",spaceBetween:40,centeredSlides:!0,speed:800,keyboard:{enabled:!0},mousewheel:{invert:!1}});t.forEach((e,t)=>{e.addEventListener("click",()=>{n.slideTo(t,1e3),gsap.set(".nav-bg",{height:"100%"})})}),n.on("slideChangeTransitionEnd",function(){let e=parseInt(document.querySelector(".swiper-slide-active").getAttribute("data-slide-score"),10)-1;t.forEach(e=>e.classList.remove("hovered")),e>=0&&e<t.length&&t[e].classList.add("hovered")});let l=gsap.timeline({}),r=!1,i=document.querySelector(".family-nav").querySelectorAll(".bg-vid");i.forEach(e=>{e.dataset.readyToPlay="false",e.addEventListener("loadeddata",function(){this.dataset.readyToPlay="true"}),e.load()}),showFamilySlider=function(){r||(r=!0,n.slideTo(a,0,!1),lenis.stop(),isMobile()&&gsap.set(".nav-page__bg",{pointerEvents:"auto"}),l.clear().progress(0),l.to(".family-nav",{height:"auto",ease:"expo.out",duration:.8}).to(".nav-bg",{height:"100%",ease:"expo.out",duration:.8},0).fromTo(".nav-page__bg",{opacity:0},{opacity:1,ease:"expo.out",duration:.8},0).fromTo(".swiper-slide.is--family",{opacity:0,yPercent:50},{opacity:1,yPercent:0,ease:"expo.out",duration:1,stagger:{each:.06}},0),i.forEach(e=>{"true"===e.dataset.readyToPlay?e.play():e.addEventListener("loadeddata",function(){this.play()},{once:!0})}))},hideFamilySlider=function(){r=!1,gsap.set(".nav-page__bg",{pointerEvents:"none",clearProps:"pointerEvents"}),lenis.start(),l.clear().progress(0),l.to(".family-nav",{height:"0px",ease:"expo.out",duration:.6}).to(".nav-bg",{height:navBoolean?"100%":"0%",overwrite:!0,ease:"expo.out",duration:.6},0).to(".nav-page__bg",{opacity:0,ease:"expo.out",duration:.6},0).fromTo(".swiper-slide.is--family",{opacity:1,yPercent:0},{opacity:0,yPercent:50,ease:"expo.out",duration:.8,stagger:{each:.02},onStart(){t.forEach(e=>e.classList.remove("hovered"))}},0),i.forEach(e=>{e.pause()})};let s=document.querySelector(".tl-w"),c=document.querySelector(".nav-w"),d=document.querySelector(".nav-page__bg");isMobile()?(s.addEventListener("click",showFamilySlider,!1),d.addEventListener("click",hideFamilySlider,!1)):(s.addEventListener("mouseenter",showFamilySlider,!1),c.addEventListener("mouseleave",hideFamilySlider,!1));let u=document.querySelector("[data-share-link]"),m=u.querySelector("[data-share-text]");u.addEventListener("click",()=>{navigator.clipboard.writeText(window.location.href).then(()=>{let e=m.innerText;m.innerText="Copied link to clipboard",setTimeout(()=>{m.innerText=e},3e3)})}),gsap.delayedCall(.1,()=>{let t=document.querySelector("[data-toggle-nav]"),o=document.querySelector("[data-family-end]"),a=e.querySelector(".nav-bg");ScrollTrigger.create({trigger:t,start:"top top+=5%",onEnter:function(){e.classList.add("scrolled"),navBoolean=!0,gsap.to(a,{height:"100%",duration:.45,ease:"expo.out",overwrite:!0})},onLeaveBack:function(){e.classList.remove("scrolled"),navBoolean=!1,gsap.to(a,{height:"0%",duration:.45,ease:"expo.out",overwrite:!0})}}),ScrollTrigger.create({trigger:o,start:"top top+=5%",onEnter:function(){e.classList.remove("scrolled"),navBoolean=!1,gsap.to(a,{height:"0%",duration:.45,ease:"expo.out",overwrite:!0})},onLeaveBack:function(){e.classList.remove("scrolled"),navBoolean=!0,gsap.to(a,{height:"100%",duration:.45,ease:"expo.out",overwrite:!0})}})}),!function e(){let t=document.querySelector('[data-modal="lightbox"]');if(!t)return;let o=document.querySelector('[data-modal="lightbox-modal"]'),a=document.querySelector(".modal-close"),n=document.querySelectorAll('[data-modal="cms-link"]'),l=document.querySelector(".modal-close");n.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),o.innerHTML="",gsap.to(".f-overlay",{opacity:.5,duration:1});let r;fetch(this.getAttribute("href")).then(e=>e.text()).then(e=>{var r,i,s;let c=new DOMParser().parseFromString(e,"text/html"),d=c.querySelector('[data-modal="cms-page-content"]');c.querySelector("title").textContent,window.location.origin,o.appendChild(d);let u;(currentTimeline=(i=(r=d).querySelectorAll('[data-modal="page-link"]'),s=r.querySelectorAll('[data-modal="page-detail"]'),(u=gsap.timeline({defaults:{ease:"expo.inOut",duration:.45},onReverseComplete(){lenis.start()},onStart(){lenis.stop(),initialNav=navBoolean,navBoolean=!0}})).set(t,{display:"block",onComplete(){o.scrollTop=0,navBoolean=initialNav}}).fromTo(o,{y:"100vh"},{y:"0vh",duration:1},0).to(".nav-bg",{height:"100%"},0).fromTo(l,{height:"0rem"},{height:"3.5rem"},.55).fromTo([...i,...s],{opacity:0,yPercent:50},{opacity:1,yPercent:0,duration:.5,overwrite:!0,stagger:{each:.05}},.4),window.innerWidth<992&&u.to("[data-nav-fade]",{autoAlpha:0,y:"1rem",duration:.35,stagger:.025},0),u)).timeScale(1).play();let m;(m=t.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"))[m.length-1].addEventListener("focusout",function(){a.focus()});setupSaveIconClickHandlers(),updateAllSaveIcons(savedModels),document.querySelectorAll('[data-modal="page-link"]').forEach((e,t)=>{e.addEventListener("click",function(e){n=null,n=document.querySelectorAll('[data-modal="cms-link"]'),e.preventDefault();var o=t;currentTimeline.timeScale(1.4).reverse().eventCallback("onReverseComplete",function(){n[o].click()})})})})})}),new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0,view:window}),a.addEventListener("click",function(){currentTimeline&&(currentTimeline.reverse(),gsap.to(".f-overlay",{opacity:0,duration:.6}))}),document.addEventListener("keydown",function(e){!t.contains(e.target)&&currentTimeline&&(currentTimeline.reverse(),gsap.to(".f-overlay",{opacity:0,duration:.6}))}),document.addEventListener("click",function(e){"Escape"===e.key&&currentTimeline&&(currentTimeline.reverse(),gsap.to(".f-overlay",{opacity:0,duration:.6}))})}(),setTimeout(()=>{document.querySelectorAll(".family-video").forEach(e=>{e.play()})},500)}shareButton&&shareButton.addEventListener("click",generateShareableLink);
